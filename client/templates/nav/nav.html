<template name="nav">
  <nav>
    {{> sidenav}}
    <div class="nav-wrapper">
      <ul class="left">
        <li><a href="#" data-activates="slide-out" class="button-collapse show-on-large"><i class="mdi-navigation-menu"></i></a></li>
      </ul>
      <ul class="right">
        {{#if currentUser}}
          {{> notificationsDropdown}}
          {{> userDropdown}}
        {{/if}}
      </ul>
    </div>
  </nav>
</template>

<template name="sidenav">
  <ul id="slide-out" class="side-nav">
    <li id="logo-container">
      <a id="logo" href="{{pathFor 'initiatives'}}">Cherish</a>
    </li>
    <!-- Removing this for now, as it serves no purpose -->
    <!--<li><a href="{{pathFor 'about'}}">About</a></li>-->
    {{#if currentUser }}
      <li><a href="{{pathFor 'profile'}}">My Profile</a></li>
      <li><a class="logout" href="#">Sign out</a></li>
    {{else}}
      <li><a href="{{pathFor 'login'}}">Sign in</a></li>
      <li><a href="{{pathFor 'signup'}}">Register</a></li>
    {{/if}}
  </ul>
</template>

<template name="userDropdown">
  <li class="user-profile">
    <ul id="profile-dropdown" class="dropdown-content">
      <li><a href="{{pathFor 'profile'}}">My profile</a></li>
      <li><a href="{{pathFor 'initiatives.mine'}}">My Initiatives</a></li>
      <li class="divider"></li>
      <li><a class="logout" href="#">Sign out</a></li>
    </ul>
    <a class="dropdown-button" href="#!" data-activates="profile-dropdown">
      <img src="{{avatar}}" class="circle responsive-img" alt="" width="30" height="30">
      {{currentUser.profile.name}}
      <i class="mdi-navigation-arrow-drop-down right"></i>
    </a>
  </li>
</template>

<template name="notificationsDropdown">
  <li class="notifications">
    <ul id="notifications-dropdown" class="dropdown-content">
    {{#each notifications}}
      <li>
        <a href="#!" class="notification-link">
          <div class="notifications-content"><i class="{{getNotificationsIcon}}"></i> <p>{{getNotificationsContent}}</p></div>
          <span class="notifications-date">{{getPrettyDate createdAt}}</span>
          <span class="notifications-author">By: {{getUserWhoTriggeredNotification userId}}</span>
        </a>
      </li>
    {{else}}
      <li><a href="#"><em>No notifications</em></a></li>
    {{/each}}  
    </ul>
    <a class="dropdown-button" href="#" data-activates="notifications-dropdown">     
      <i class="mdi-social-notifications{{#unless hasNotifications}}-none{{/unless}} center"></i> {{getNotificationsCount}}
    </a>
  </li>
</template>